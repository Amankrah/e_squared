CREATE TABLE IF NOT EXISTS backtest_results (
  id TEXT PRIMARY KEY,
  user_id TEXT NOT NULL,
  name TEXT NOT NULL,
  description TEXT,
  strategy_name TEXT NOT NULL,
  symbol TEXT NOT NULL,
  interval TEXT NOT NULL,
  start_date TEXT NOT NULL,
  end_date TEXT NOT NULL,
  initial_balance REAL NOT NULL,
  final_balance REAL NOT NULL,
  total_return REAL NOT NULL,
  total_return_percentage REAL NOT NULL,
  max_drawdown REAL NOT NULL,
  max_drawdown_percentage REAL NOT NULL,
  sharpe_ratio REAL,
  total_trades INTEGER NOT NULL,
  winning_trades INTEGER NOT NULL,
  losing_trades INTEGER NOT NULL,
  win_rate REAL NOT NULL,
  profit_factor REAL,
  largest_win REAL NOT NULL,
  largest_loss REAL NOT NULL,
  average_win REAL NOT NULL,
  average_loss REAL NOT NULL,
  strategy_parameters TEXT NOT NULL,
  trades_data TEXT NOT NULL,
  equity_curve TEXT NOT NULL,
  drawdown_curve TEXT NOT NULL,
  status TEXT NOT NULL DEFAULT 'running',
  error_message TEXT,
  execution_time_ms INTEGER,
  created_at TEXT NOT NULL,
  updated_at TEXT NOT NULL,
  FOREIGN KEY (user_id) REFERENCES users (id) ON DELETE CASCADE
);